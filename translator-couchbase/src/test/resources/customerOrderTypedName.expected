SET NAMESPACE 'http://www.teiid.org/translator/couchbase/2017' AS teiid_couchbase;

CREATE FOREIGN TABLE Customer (
	"_documentId" string OPTIONS (UPDATABLE FALSE),
	ID string OPTIONS (NAMEINSOURCE '`ID`'),
	type string OPTIONS (NAMEINSOURCE '`type`'),
	Name string OPTIONS (NAMEINSOURCE '`Name`'),
	CONSTRAINT PK0 PRIMARY KEY("_documentId")
) OPTIONS (NAMEINSOURCE '`test`', UPDATABLE TRUE, "teiid_couchbase:ISARRAYTABLE" 'false');

CREATE FOREIGN TABLE Items (
	"_documentId" string OPTIONS (UPDATABLE FALSE),
	Items_idx integer OPTIONS (UPDATABLE FALSE),
	Items_Quantity integer OPTIONS (NAMEINSOURCE '`Quantity`'),
	Items_ItemID integer OPTIONS (NAMEINSOURCE '`ItemID`'),
	FOREIGN KEY("_documentId") REFERENCES Oder 
) OPTIONS (NAMEINSOURCE '`Items`[]', UPDATABLE TRUE, "teiid_couchbase:ISARRAYTABLE" 'true');

CREATE FOREIGN TABLE Oder (
	"_documentId" string OPTIONS (UPDATABLE FALSE),
	CustomerID string OPTIONS (NAMEINSOURCE '`CustomerID`'),
	type string OPTIONS (NAMEINSOURCE '`type`'),
	CreditCard_CardNumber string OPTIONS (NAMEINSOURCE '`CreditCard`.`CardNumber`'),
	CreditCard_Type string OPTIONS (NAMEINSOURCE '`CreditCard`.`Type`'),
	CreditCard_CVN integer OPTIONS (NAMEINSOURCE '`CreditCard`.`CVN`'),
	CreditCard_Expiry string OPTIONS (NAMEINSOURCE '`CreditCard`.`Expiry`'),
	Name string OPTIONS (NAMEINSOURCE '`Name`'),
	CONSTRAINT PK0 PRIMARY KEY("_documentId")
) OPTIONS (NAMEINSOURCE '`test`', UPDATABLE TRUE, "teiid_couchbase:ISARRAYTABLE" 'false');

CREATE FOREIGN TABLE SavedAddresses (
	"_documentId" string OPTIONS (UPDATABLE FALSE),
	SavedAddresses_idx integer OPTIONS (UPDATABLE FALSE),
	SavedAddresses string OPTIONS (NAMEINSOURCE '`SavedAddresses`[]'),
	FOREIGN KEY("_documentId") REFERENCES Customer 
) OPTIONS (NAMEINSOURCE '`SavedAddresses`[]', UPDATABLE TRUE, "teiid_couchbase:ISARRAYTABLE" 'true');